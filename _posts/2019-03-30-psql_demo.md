--- 
layout: post 
title: "PSQL Demo" 
date: 2019-03-30 14:28:04 
author: Dewey Mao 
categories: PostgreSQL 
--- 

PostgreSQL is case-sensitive to table and field name, so please add double or "double-double" quotation marks.

```
@ECHO OFF
setlocal enabledelayedexpansion
set file_name=%date:~0,4%-%date:~5,2%-%date:~8,2%-DMMKDB_backup
set host_name=localhost
set port_name=5432
set user_name=postgres
set db_name=DMMKDBtest

echo BACKUP DMMKDB
pg_dump -h !host_name! -p !port_name! -U !user_name! !db_name! > F:\BACKUP_DMMKDB\!file_name!
echo BACKUP DMMKDB SUCCESS
pause

echo DROPDB DMMKDBtest
dropdb -h !host_name! -p !port_name! -U !user_name! !db_name!
echo DROPDB DMMKDBtest SUCCESS
pause

echo CREATEDB DMMKDBtest
createdb -h !host_name! -p !port_name! -U !user_name! !db_name!
echo CREATEDB DMMKDBtest SUCCESS
pause

echo CREATE EXTENSION
psql -h !host_name! -p !port_name! -U !user_name! -d !db_name! -c "create extension "postgis";"
psql -h !host_name! -p !port_name! -U !user_name! -d !db_name! -c "create extension ""uuid-ossp"";"
echo CREATE EXTENSION SUCCESS
pause

echo RESTORE FROM DMMKDB
psql -h !host_name! -p !port_name! -U !user_name! !db_name! < F:\BACKUP_DMMKDB\!file_name!
echo RESTORE FROM DMMKDB SUCCESS
pause

echo MODIFY TABLE RDB_AttachmentPathConfig
psql -h !host_name! -p !port_name! -U !user_name! -d !db_name! -c "DELETE FROM ""RDB_AttachmentPathConfig"";"
psql -h !host_name! -p !port_name! -U !user_name! -d !db_name! -c "INSERT INTO ""RDB_AttachmentPathConfig"" (""AttachmentPath"", ""Note"") VALUES ('\\localhost\shared_attachment\test', 'shared folder');"
echo MODIFY TABLE RDB_AttachmentPathConfig SUCCESS
pause

```

Using "copy to" output contents to csv(WITHOUT LINE BREAK)
```
@ECHO OFF
setlocal enabledelayedexpansion
set folder_name=D:\output_drill_data
set file_name=%date:~0,4%-%date:~5,2%-%date:~8,2%-drill.csv

psql -h 172.16.14.28 -p 5432 -U postgres -d DMMKDB 
-c "copy (select "\"RDB_DrillCollar\""."\"Name\"", "\"t_bi_worksite\""."\"sitename\"", "\"RDB_DrillCollar\""."\"X\"", "\"RDB_DrillCollar\""."\"Y\"", "\"RDB_DrillCollar\""."\"Z\"","\"RDB_DrillCollar\""."\"Length\"", "\"RDB_DrillCollar\""."\"Diameter\"", "\"RDB_DrillCollar\""."\"OpeningDate\"","\"RDB_DrillCollar\""."\"CompletedDate\"", "\"RDB_DrillCollar\""."\"Cataloger\"" 
from "\"RDB_DrillCollar\"", "\"t_bi_worksite\"" 
where "\"RDB_DrillCollar\""."\"IsDesign\"" = false and "\"RDB_DrillCollar\""."\"ApprovalFlag\"" = 1 and ("\"RDB_DrillCollar\""."\"VerTo\"" is null or "\"RDB_DrillCollar\""."\"VerTo\"" = 0) and "\"RDB_DrillCollar\""."\"VerFrom\"" >= (select min("\"VerNo\"") from "\"RDB_Version\"" where "\"Time\"" >= '2019-07-26') and "\"RDB_DrillCollar\""."\"VerFrom\"" <= (select max("\"VerNo\"") from "\"RDB_Version\"" where "\"Time\"" <= '2019-08-25')and "\"t_bi_worksite\""."\"siteid\"" = "\"RDB_DrillCollar\""."\"WorkPlaceID\"") 
to '!folder_name!\!file_name!' (format csv, delimiter ',', header true);"

pause

```
